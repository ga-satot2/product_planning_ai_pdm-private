# わからない箇所：要確認リスト

**作成日**: 2026-01-27  
**作成者**: 佐藤達也  
**目的**: 明和・ライブズ販売における決済後のシステム間連携条件について、ソースコード検索で確認できなかった箇所のリスト

---

## 🔴 最重要：技術担当者への確認が必要な箇所

### 1. AGNT→FLOW連携処理

**FLOW側のリポジトリ**: `flow_by_renosy`（仕入物件に関わる会計処理システム）

**質問（AGNT側）**:
1. **AGNT側の連携処理の実装箇所はどこか？**
   - ファイルパス、クラス名、メソッド名を教えてください
   - API連携？バッチ処理？その他の方法？

2. **連携のトリガーは何か？**
   - 契約ステータス遷移時？（どのステータス？）
   - 決済完了時？
   - 契約書アップロード時？
   - その他のタイミング？

3. **手作業アップロード時の連携はどうなるか？**
   - クラウドサインで締結した契約書を手作業でAGNTにアップロードした場合、FLOWへの連携が自動的に行われるか？
   - 連携される条件は何か？（契約ステータスの更新が必要か？）

4. **連携されるデータの内容は？**
   - 契約情報、決済情報、物件情報など、どのようなデータが連携されるか？

**質問（FLOW側）**:
5. **FLOW側のデータ受信処理の実装箇所はどこか？**
   - ファイルパス、クラス名、メソッド名を教えてください
   - APIエンドポイント？バッチ処理？その他の方法？

6. **FLOW側で受信するデータの形式は？**
   - どのような形式でデータを受信するか？（JSON？その他？）
   - 受信したデータをどのように処理するか？

7. **FLOW側での決済処理のトリガーは？**
   - AGNTで決済日設定 → FLOWで日時監視 → 17時到達 → 決済実行
   - このフローで、AGNTからの連携データはどのように使用されるか？

---

### 2. AGNT→MANAGE連携処理

**質問**:
1. **連携処理の実装箇所はどこか？**
   - ファイルパス、クラス名、メソッド名を教えてください
   - API連携？バッチ処理？その他の方法？

2. **「MANAGE連携」ボタンの処理内容は？**
   - ボタンクリック時に実行される処理の詳細
   - 連携されるデータの内容

3. **連携のトリガーは何か？**
   - 契約ステータス遷移時？（どのステータス？）
   - 決済完了時？
   - 手動ボタン押下時？
   - その他のタイミング？

4. **他社管理物件の場合の連携条件は？**
   - `manage_type`が`other`の場合、連携条件が変わるか？
   - 連携されるデータに`manage_type`が含まれるか？

5. **手作業アップロード時の連携はどうなるか？**
   - クラウドサインで締結した契約書を手作業でAGNTにアップロードした場合、MANAGEへの連携が自動的に行われるか？
   - 連携される条件は何か？（契約ステータスの更新が必要か？手動ボタン押下が必要か？）

---

### 3. OWRアプリでの契約書表示処理

**質問**:
1. **契約書表示処理の実装箇所はどこか？**
   - ファイルパス、クラス名、メソッド名を教えてください
   - `renosy_asset`側？`ownr_server`側？

2. **表示に必要なデータ構造は？**
   - `contract_file`と`document_sign_file`のどちらが必要か？
   - または両方必要か？
   - その他の条件は？

3. **データ取得方法は？**
   - `ownr_server`がAGNTから契約書データを取得する方法（API？バッチ？）
   - 取得タイミングは？（リアルタイム？定期バッチ？）

4. **手作業アップロード時の表示はどうなるか？**
   - クラウドサインで締結した契約書を手作業でAGNTにアップロードした場合、`contract_file`または`document_sign_file`として適切に保存されればOWNRアプリで表示されるか？
   - 表示されるまでの処理フローは？（AGNT→ownr_server→OWNRアプリ）

5. **他社管理物件の場合の表示制御は？**
   - `manage_type`が`other`の場合、契約書が表示されるか？
   - 表示制御の条件は？

---

### 4. 契約書手作業アップロード時の処理フロー

**質問**:
1. **手作業アップロードの具体的な手順は？**
   - クラウドサインで締結した契約書を手作業でAGNTにアップロードする際の具体的な手順
   - どの画面からアップロードするか？
   - アップロード時に必要な情報は？

2. **アップロード時の処理内容は？**
   - `contract_file`の作成処理
   - 契約ステータスの更新処理
   - その他の処理（コールバック処理など）

3. **ステータス遷移はどうなるか？**
   - 手作業アップロード時に契約ステータスがどのように遷移するか？
   - `contract_preparation`に遷移するか？
   - その他のステータスに遷移するか？

4. **連携トリガーはどうなるか？**
   - 手作業アップロード後に、FLOW/MANAGEへの連携が自動的に行われるか？
   - 連携される条件は何か？

---

## 📋 確認先

### AGNT（verdandi）担当者
- **確認事項**: 1, 2, 4（AGNT→FLOW連携、AGNT→MANAGE連携、契約書アップロード処理）

### FLOW（flow_by_renosy）担当者
- **確認事項**: 1（AGNTからのデータ受信処理）
- **リポジトリ名**: `flow_by_renosy`（仕入物件に関わる会計処理システム）

### MANAGE担当者
- **確認事項**: 2（AGNTからのデータ受信処理、他社管理物件の登録方法）

### OWRアプリ（renosy_asset）担当者
- **確認事項**: 3（契約書表示処理）

### ownr_server担当者
- **確認事項**: 3（AGNTからの契約書データ取得処理）

---

## 📝 確認時の注意事項

1. **具体的なファイルパス・クラス名・メソッド名を聞く**
   - 実装箇所を特定できるようにする

2. **トリガー条件を明確にする**
   - 契約ステータス？決済完了？手動操作？その他？

3. **手作業アップロード時の動作を確認する**
   - クラウドサインで締結した契約書を手作業でアップロードした場合の動作

4. **他社管理物件の場合の動作を確認する**
   - `manage_type`が`other`の場合の連携・表示条件

---

## 🔗 関連ドキュメント

- [決済後連携確認ポイント](./決済後連携確認ポイント.md) - 詳細な確認ポイントと仮説
- [販売プロセス手順書](../3_executing/sales_process.md) - 明和・ライブズ販売の手順
- [論点調査結果](../2_planning/investigation_results.md) - ソースコード調査結果
