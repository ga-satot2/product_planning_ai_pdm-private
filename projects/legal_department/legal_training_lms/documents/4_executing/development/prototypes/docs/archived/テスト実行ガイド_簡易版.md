# テスト実行ガイド（簡易版）

**作成日**: 2025-12-26

---

## 🚀 クイックスタート

### 1. Apps Scriptエディタを開く

以下のURLをブラウザで開いてください：

**https://script.google.com/d/1DiZUSkJU_Z4Yc0bBcNgOUH3iqHux8xnSS7qILL5YZMfKgw86QeMvx0S-/edit**

### 2. テスト用データの準備

1. 関数選択ドロップダウン（上部）から **`createTestEvent`** を選択
2. **「実行」** ボタン（▶️）をクリック
3. 初回実行時は権限の承認が必要な場合があります
4. 実行ログで `eventId` を確認

### 3. 統合テストの実行

1. 関数選択ドロップダウンから **`testAllUntestedFunctions`** を選択
2. **「実行」** ボタンをクリック
3. 実行ログを確認

---

## 📋 実行されるテスト一覧

`testAllUntestedFunctions()` を実行すると、以下のテストが順次実行されます：

1. ✅ `testRefreshAttendeeStatus()` - 出席情報更新テスト
2. ✅ `testHandleReservationFormSubmit()` - フォーム送信処理テスト
3. ✅ `testOnCreatingSchedule()` - スケジュール作成テスト
4. ✅ `testOnDashboardAction()` - ダッシュボード操作テスト
5. ✅ `testEditHandler()` - 編集ハンドラーテスト
6. ✅ `testEnhancedFunctions()` - 予約管理機能テスト
7. ✅ `testCalendarEnhancedFunctions()` - カレンダー連携テスト
   - `updateCalendarEvent()` - イベント更新（元に戻す処理あり）
   - `handleCancellation()` - キャンセル処理（状態を元に戻す処理あり）
8. ✅ `testReservationChangeFunctions()` - 予約変更機能テスト
9. ✅ `testChangeReservation()` - 予約変更テスト（修正版、2つ目のeventIdを自動生成）

---

## ✅ 期待される結果

すべてのテストが成功すると、実行ログに以下のように表示されます：

```
=== testAllUntestedFunctions: 開始 ===
...
✅ すべての未テスト関数のテストが完了しました！
```

---

## ⚠️ 注意事項

1. **テスト用データのみを使用**
   - テスト用email: `t_sato2@ga-tech.co.jp`
   - テスト用イベント: タイトルに「テスト」を含む

2. **実際の従業員データに影響なし**
   - テスト実行者のemailのみを対象にします
   - テスト用イベントのみを使用します

3. **カレンダーイベントの更新**
   - `updateCalendarEvent()` はテスト後に元のタイトルに戻します
   - `handleCancellation()` はテスト後に状態を元に戻します

---

## 🔧 トラブルシューティング

### エラー: "テスト用データが取得できませんでした"

**解決策**: `createTestEvent()` を先に実行してください

### エラー: "CALENDAR_ID が未設定です"

**解決策**: 
1. Apps Scriptエディタで「プロジェクトの設定」（⚙️）をクリック
2. 「スクリプトプロパティ」タブを開く
3. `CALENDAR_ID` を追加して、GoogleカレンダーのIDを設定

### エラー: "権限が不足しています"

**解決策**: 
1. 実行時に表示される権限承認ダイアログで「許可」をクリック
2. Googleアカウントでログインしていることを確認

---

## 📊 テスト結果の確認

実行ログで以下の記号を確認してください：

- ✅: テスト成功
- ⚠️: 警告（期待値と異なるが、エラーではない）
- ❌: エラーが発生

---

## 🔗 関連ドキュメント

- [テスト実行手順書](テスト実行手順書.md) - 詳細な手順
- [機能全体像とテストカバレッジ](../../機能全体像とテストカバレッジ.md)
- [テスト観点とカバレッジ分析](../../テスト観点とカバレッジ分析.md)

---

**作成者**: プロダクト企画チーム  
**最終更新**: 2025-12-26



