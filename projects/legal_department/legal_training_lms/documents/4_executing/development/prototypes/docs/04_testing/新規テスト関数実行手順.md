# 新規テスト関数実行手順

**作成日**: 2025年12月26日  
**目的**: 新規追加されたテスト関数の実行手順

---

## 📋 実行手順

### 1. Google Apps Scriptエディタを開く

1. スプレッドシートを開く: https://docs.google.com/spreadsheets/d/1ln9GGhT7wbhhsWPIeATGkAnfAkXFvH8CfUeuZqmgqpE/edit
2. 「拡張機能」→「Apps Script」をクリック
3. Apps Scriptエディタが開きます

### 2. テスト関数を実行

#### 方法1: 統合テスト関数を実行（推奨）

1. 関数選択ドロップダウンから`testAllNewFunctions`を選択
2. 「実行」ボタンをクリック
3. 実行ログを確認

**実行されるテスト**:
- ✅ `testGetReservedCountForGroupAndCourse()` - 安全（読み取りのみ）
- ✅ `testGetCourseNumberFromCourseListByCourseName()` - 安全（読み取りのみ）
- ✅ `testUpdateDashboardAfterReservation()` - 注意（ダッシュボードを更新）
- ⚠️ その他のテストは安全のためスキップ

#### 方法2: 個別テスト関数を実行

##### 安全なテスト（読み取りのみ）

1. **`testGetReservedCountForGroupAndCourse()`**
   - 関数選択: `testGetReservedCountForGroupAndCourse`
   - 実行ボタンをクリック
   - ログで各グループ・コースの予約済み人数を確認

2. **`testGetCourseNumberFromCourseListByCourseName()`**
   - 関数選択: `testGetCourseNumberFromCourseListByCourseName`
   - 実行ボタンをクリック
   - ログでコース名から番号が正しく取得できるか確認

##### 注意が必要なテスト（データを変更）

3. **`testUpdateDashboardAfterReservation()`**
   - ⚠️ **注意**: このテストは実際にダッシュボードを更新します
   - 関数選択: `testUpdateDashboardAfterReservation`
   - 実行ボタンをクリック
   - ログでダッシュボードの更新を確認

##### 高度なテスト（手動実行が必要）

以下のテストは、実際にカレンダーイベントやメールを操作するため、**手動で個別に実行**してください：

4. **`testDeleteCalendarEvent()`**
   - ⚠️ **注意**: 実際にカレンダーイベントを削除します
   - テスト用イベントのみを使用してください
   - `createTestEvent()`で作成したイベントのeventIdを使用

5. **`testSyncCalendarOnReservationChange()`**
   - ⚠️ **注意**: 実際にカレンダーイベントを変更します
   - テスト用イベントが2つ以上必要です

6. **`testSendReservationConfirmationEmail()`**
   - ⚠️ **注意**: 実際にメールを送信する可能性があります
   - テスト用メールアドレスを使用してください

7. **`testSendReservationChangeEmail()`**
   - ⚠️ **注意**: 実際にメールを送信する可能性があります
   - テスト用メールアドレスを使用してください

8. **`testSendCancellationEmail()`**
   - ⚠️ **注意**: 実際にメールを送信する可能性があります
   - テスト用メールアドレスを使用してください

---

## 📊 実行結果の確認

### ログの確認方法

1. Apps Scriptエディタで「実行」ボタンの下にある「実行ログ」をクリック
2. ログに以下のような出力が表示されます：

```
=== testGetReservedCountForGroupAndCourse: 開始 ===

1. 各グループ・コースの予約済み人数を取得...
   1期生 / コンプライアンス/会社ルールについて: 5人
   1期生 / 個人情報保護法について: 3人
   ...

=== testGetReservedCountForGroupAndCourse: 完了 ===
```

### 成功の確認

- ✅ マークが表示されている
- ❌ マークが表示されていない
- エラーメッセージが表示されていない

### エラーが発生した場合

1. エラーメッセージをコピー
2. エラーが発生したテスト関数名を記録
3. エラーの原因を特定
4. 必要に応じて修正

---

## 🔄 テスト実行の流れ

### 推奨実行順序

1. **安全なテストから実行**
   ```
   testGetReservedCountForGroupAndCourse()
   → testGetCourseNumberFromCourseListByCourseName()
   ```

2. **データ更新テスト**
   ```
   testUpdateDashboardAfterReservation()
   ```

3. **統合テスト**
   ```
   testAllNewFunctions()
   ```

4. **高度なテスト（必要に応じて）**
   ```
   testDeleteCalendarEvent()
   testSyncCalendarOnReservationChange()
   testSendReservationConfirmationEmail()
   testSendReservationChangeEmail()
   testSendCancellationEmail()
   ```

---

## 📝 実行結果の記録

テスト実行後、以下の情報を記録してください：

1. **実行日時**: YYYY-MM-DD HH:MM:SS
2. **実行したテスト関数**: 関数名のリスト
3. **実行結果**: ✅ 成功 / ❌ 失敗
4. **エラー内容**: エラーが発生した場合の詳細
5. **備考**: その他の注意事項

---

## 🔗 関連ドキュメント

- [テスト実行状況・サマリー](テスト実行状況・サマリー.md)
- [テストセットアップ・実行ガイド](テストセットアップ・実行ガイド.md)
- [テスト実行時の安全対策方針](TEST_SAFETY_POLICY.md)

---

**作成者**: プロダクト企画チーム  
**最終更新**: 2025年12月26日
