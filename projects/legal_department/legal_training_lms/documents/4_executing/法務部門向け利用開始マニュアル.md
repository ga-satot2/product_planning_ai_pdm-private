# 法務部門向け利用開始マニュアル

**作成日**: 2025-12-26  
**対象**: 法務部門管理者・運用担当者  
**バージョン**: 1.0

---

## 📋 目次

1. [システム概要](#システム概要)
2. [利用開始前の準備](#利用開始前の準備)
3. [基本的な操作方法](#基本的な操作方法)
4. [よくある質問（FAQ）](#よくある質問faq)
5. [トラブルシューティング](#トラブルシューティング)
6. [サポート体制](#サポート体制)

---

## システム概要

### システムの目的

法務研修LMSシステムは、法務部門の継続研修を効率的に管理するためのシステムです。

### 主な機能

1. **研修コース管理**
   - 研修コースの登録・編集
   - 3グループ（1期生、2期生、3期生）への振り分け

2. **予約管理**
   - 参加希望日の予約
   - 予約変更機能（3日前まで、1回まで）
   - キャンセル機能

3. **出席管理**
   - Google Calendarからの自動出席情報更新
   - 参加情報の可視化

4. **通知機能**
   - 未予約者へのリマインド通知（Slack）

### システム構成

- **スプレッドシート**: データ管理
- **Google Calendar**: イベント管理
- **Google Forms**: 予約フォーム（**1期生、2期生、3期生の3つのフォーム**）
- **Slack**: 通知機能

---

## 利用開始前の準備

### 1. データの準備

#### 1.1 イベント・登録者名簿の確認

- [ ] イベント一覧が正しく登録されているか確認
- [ ] 登録者名簿が最新であるか確認

#### 1.2 第3期生の出欠予約データの最新化

詳細は「[データインポート手順書](development/prototypes/docs/データインポート手順書.md)」を参照してください。

**実行手順**:
1. Apps Scriptエディタを開く
2. `importReservationData()`関数を実行
3. インポート結果を確認

### 2. Slack設定

#### 2.1 Slack Appの追加

詳細は「[Slack App設定手順書](development/prototypes/docs/Slack_App設定手順書.md)」を参照してください。

**必要な作業**:
- [ ] 1期生チャンネルにIncoming Webhookを追加
- [ ] 2期生チャンネルにIncoming Webhookを追加
- [ ] 3期生チャンネルにIncoming Webhookを追加
- [ ] スクリプトプロパティにWebhook URLを設定

### 3. システム設定の確認

- [ ] Google Calendar IDが正しく設定されているか確認
- [ ] スプレッドシートIDが正しく設定されているか確認
- [ ] Slack設定が正しく設定されているか確認

---

## 基本的な操作方法

### 1. 研修コースの登録

#### 1.1 予約一覧シートへの登録

1. **スプレッドシートを開く**
   ```
   https://docs.google.com/spreadsheets/d/1ln9GGhT7wbhhsWPIeATGkAnfAkXFvH8CfUeuZqmgqpE/edit
   ```

2. **「予約一覧」シートを開く**

3. **新しい行に研修情報を入力**
   - A列: 連番（自動）
   - B列: コース名
   - C列: コース詳細
   - D列: 開催日
   - E列: 開始時刻
   - F列: 終了時刻
   - G列: イベントURL（自動生成）
   - H列: トリガー（「作成」と入力）
   - I列: 対象グループ（1期生、2期生、3期生、またはAll）
   - J列: 最大参加者数

4. **トリガー列に「作成」と入力**
   - これにより、Google Calendarにイベントが自動的に作成されます

#### 1.2 カレンダーイベントの確認

1. **Google Calendarを開く**
2. **作成されたイベントを確認**
   - イベントタイトル: `[対象グループ] コース名`
   - 日時: 設定した日時
   - 説明: コース詳細

### 2. 予約フォームの再生成

#### 2.1 フォーム再生成の概要

システムでは、**1期生、2期生、3期生の3つのフォーム**をそれぞれ管理しています。各グループ用のフォームが個別に作成・管理されます。

#### 2.2 全グループのフォームを一括再生成（推奨）

**`rebuildTrainingFormsForAllGroups()`関数を使用**

1. **Apps Scriptエディタを開く**
   ```
   https://script.google.com/u/0/home/projects/1lGAGi8GO625JPsXhyWEY0M_TlJeaxBGCf1n4YkX92vkgWxJnEQFrd7LL/edit
   ```
   **注意**: フォーム側プロジェクトのApps Scriptエディタを開きます

2. **`rebuildTrainingFormsForAllGroups`関数を選択**

3. **「実行」ボタンをクリック**

4. **実行ログを確認**
   - 1期生、2期生、3期生の各フォームが正常に再生成されたことを確認
   - 各フォームのIDが表示されます

**期待されるログ**:
```
=== form_rebuildTrainingFormsForAllGroups: 開始 ===
📋 対象グループ: 1期生, 2期生, 3期生

📝 グループ「1期生」のフォームを作成中...
✅ グループ「1期生」のフォームを作成しました: [フォームID]

📝 グループ「2期生」のフォームを作成中...
✅ グループ「2期生」のフォームを作成しました: [フォームID]

📝 グループ「3期生」のフォームを作成中...
✅ グループ「3期生」のフォームを作成しました: [フォームID]

=== form_rebuildTrainingFormsForAllGroups: 完了 ===
```

#### 2.3 特定グループのフォームのみ再生成

特定のグループのフォームのみを再生成する場合：

1. **Apps Scriptエディタを開く**（フォーム側プロジェクト）

2. **`rebuildTrainingFormForGroup`関数を選択**

3. **関数の引数を設定**
   - 関数内で`groupName`パラメータを指定
   - 例: `rebuildTrainingFormForGroup('1期生')`

4. **「実行」ボタンをクリック**

#### 2.4 フォームURLの確認

**重要**: フォームURLは**グループ一覧シートのE列（FORM_URL列）**に自動的に保存されます。

**確認方法**:

1. **スプレッドシートを開く**
   ```
   https://docs.google.com/spreadsheets/d/1ln9GGhT7wbhhsWPIeATGkAnfAkXFvH8CfUeuZqmgqpE/edit
   ```

2. **「グループ一覧」シートを開く**

3. **E列（FORM_URL列）を確認**
   - 1期生の行のE列: 1期生用フォームURL
   - 2期生の行のE列: 2期生用フォームURL
   - 3期生の行のE列: 3期生用フォームURL

**フォームURLの形式**:
```
https://docs.google.com/forms/d/[フォームID]/viewform
```

**注意事項**:
- `rebuildTrainingFormsForAllGroups()`を実行すると、自動的にE列にフォームURLが書き込まれます
- フォームURLが空欄の場合は、`rebuildTrainingFormsForAllGroups()`を再実行してください
- 各グループの参加者には、**グループ一覧シートのE列に記載されているURL**を共有してください

### 3. リマインド通知の送信

#### 3.1 ダッシュボードシートからの送信

1. **「ダッシュボード」シートを開く**

2. **対象グループ・コースの行を確認**

3. **F列（リマインド）をクリック**
   - これにより、該当グループ・コースの未予約者にSlack通知が送信されます

4. **Slackチャンネルで通知を確認**

#### 3.2 通知内容の確認

通知には以下の情報が含まれます：
- 対象グループ・コース名
- 未予約者リスト
- 予約フォームへのリンク

### 4. 参加情報の更新

#### 4.1 自動更新（推奨）

システムは自動的にGoogle Calendarから参加情報を更新します。

**更新タイミング**:
- スプレッドシート編集時
- 手動実行時

#### 4.2 手動更新

1. **Apps Scriptエディタを開く**

2. **`refreshAttendeeStatus()`関数を選択**

3. **「実行」ボタンをクリック**

4. **実行ログを確認**
   - 更新が正常に完了したことを確認

---

## よくある質問（FAQ）

### Q1: 予約フォームを再生成するタイミングは？

**A**: 以下のタイミングで再生成してください：
- 新しい研修コースを追加した時
- 既存の研修コースの情報を変更した時
- 研修枠を追加・削除した時

**注意**: システムでは**1期生、2期生、3期生の3つのフォーム**が個別に管理されています。`rebuildTrainingFormsForAllGroups()`関数を実行すると、3つのフォームすべてが一括で再生成されます。

### Q2: リマインド通知はどのタイミングで送信すればよいですか？

**A**: 研修日の3日前までに送信することを推奨します。必要に応じて、複数回送信することも可能です。

### Q3: 予約変更はどのように行いますか？

**A**: 参加者は予約フォームから予約変更を行うことができます。変更可能な条件は以下の通りです：
- 研修日の3日前まで
- 1回まで変更可能

### Q4: 参加情報が正しく更新されない場合は？

**A**: 以下の手順を試してください：
1. `refreshAttendeeStatus()`関数を手動実行
2. Google Calendarのイベントに参加者が正しく追加されているか確認
3. スプレッドシートの「参加情報」シートを確認

### Q5: エラーが発生した場合は？

**A**: 以下の手順を試してください：
1. 実行ログを確認してエラーメッセージを確認
2. 「[トラブルシューティング](#トラブルシューティング)」セクションを参照
3. 問題が解決しない場合は、サポートに連絡

---

## トラブルシューティング

### 問題1: カレンダーイベントが作成されない

**原因**:
- トリガー列に「作成」と入力していない
- Google Calendar IDが正しく設定されていない

**解決方法**:
1. トリガー列に「作成」と入力しているか確認
2. Apps ScriptのスクリプトプロパティでGoogle Calendar IDを確認

### 問題2: リマインド通知が送信されない

**原因**:
- Slack Webhook URLが正しく設定されていない
- チャンネルIDが正しく設定されていない

**解決方法**:
1. Apps ScriptのスクリプトプロパティでSlack設定を確認
2. 「[Slack App設定手順書](development/prototypes/docs/Slack_App設定手順書.md)」を参照

### 問題3: 参加情報が更新されない

**原因**:
- Google Calendarのイベントに参加者が追加されていない
- `refreshAttendeeStatus()`関数が実行されていない

**解決方法**:
1. Google Calendarのイベントを確認
2. `refreshAttendeeStatus()`関数を手動実行
3. 実行ログを確認

### 問題4: 予約フォームが表示されない

**原因**:
- フォームが再生成されていない
- フォームURLが間違っている
- グループ別のフォームURLを間違えている

**解決方法**:
1. **全グループのフォームを再生成**
   - `rebuildTrainingFormsForAllGroups()`関数を実行（フォーム側プロジェクト）
   - 実行ログで各グループのフォームIDを確認

2. **フォームURLの確認**
   - **グループ一覧シートのE列（FORM_URL列）**を確認
   - 各グループの行のE列にフォームURLが記載されていることを確認
   - URL形式: `https://docs.google.com/forms/d/[フォームID]/viewform`

3. **グループ別のURLを確認**
   - 1期生用、2期生用、3期生用のフォームURLがそれぞれ異なることを確認
   - **グループ一覧シートのE列に記載されているURL**を各グループの参加者に共有しているか確認

### 問題5: システムの動作確認をしたい

**システムの動作確認方法**:

システムが正常に動作しているか確認するには、以下の手順を実行してください：

1. **Apps Scriptエディタを開く**
   ```
   https://script.google.com/d/1DiZUSkJU_Z4Yc0bBcNgOUH3iqHux8xnSS7qILL5YZMfKgw86QeMvx0S-/edit
   ```

2. **`testAllUntestedFunctions`関数を実行**
   - 関数選択ドロップダウンから`testAllUntestedFunctions`を選択
   - 「実行」ボタンをクリック
   - 実行ログを確認

3. **実行ログの確認**
   - 「実行ログ」ボタンをクリックしてログパネルを開く
   - すべてのテストが「✅」で完了していることを確認
   - エラー（❌）が表示されている場合は、エラーメッセージを確認

**期待される結果**:
- すべてのテストが正常に完了する
- エラーメッセージが表示されない
- 実行ログに「✅ すべての未テスト関数のテストが完了しました！」と表示される

**注意事項**:
- テスト実行には数分かかることがあります
- テスト実行中は、スプレッドシートやカレンダーの操作を控えてください
- エラーが発生した場合は、サポートに連絡してください

---

## サポート体制

### 初回利用時のサポート

- **期間**: 利用開始時から1週間
- **内容**: 基本的な操作方法の説明、設定確認

### 問題発生時のサポート

- **対応方法**: 問題が発生した場合のみ対応
- **連絡先**: [連絡先を記載]

### 定期メンテナンス

**重要**: システムは完全自動化されており、**定期的なメンテナンスは不要**です。

**理由**:
- Google Apps Scriptは自動的にメンテナンスされる
- スプレッドシート・カレンダーはGoogleが管理
- システムは完全自動化されており、手動メンテナンス不要

**必要な場合の対応**:
- バグ修正: 問題発生時に修正対応
- 機能追加: 新機能が必要な場合に追加開発
- データ不整合: 問題発生時にデータ修正

### システムの動作確認（推奨）

システムが正常に動作しているか定期的に確認することを推奨します。

**確認頻度**:
- 月1回程度の動作確認を推奨
- 問題が発生した場合は、すぐに動作確認を実施

**確認方法**:
1. Apps Scriptエディタを開く
2. `testAllUntestedFunctions`関数を実行
3. 実行ログでエラーがないことを確認

詳細は「[トラブルシューティング](#トラブルシューティング)」セクションの「問題5: システムの動作確認をしたい」を参照してください。

---

## 📚 関連ドキュメント

- [データインポート手順書](development/prototypes/docs/データインポート手順書.md)
- [Slack App設定手順書](development/prototypes/docs/Slack_App設定手順書.md)
- [利用開始準備タスク](利用開始準備タスク.md)
- [システム設計書](../3_planning/法務研修LMSシステム設計書.md)

---

## 📝 更新履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2025-12-26 | 1.0 | 初版作成 |
| 2026-01-15 | 1.1 | システムの動作確認方法を追加 |
| 2026-01-15 | 1.2 | フォームが3つ（1期生、2期生、3期生用）に分かれていることを明記 |

---

**作成者**: プロダクト企画チーム  
**最終更新**: 2026-01-15



